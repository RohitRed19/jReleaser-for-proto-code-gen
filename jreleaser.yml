# JReleaser Configuration for grpc-services
# This configuration creates GitLab releases with Go-compatible tags (v{version})
# matching the Maven POM version.

# Project metadata - version is read from pom.xml automatically when using Maven plugin
project:
  name: grpc-services
  description: gRPC Services for Java and Go
  versionPattern: SEMVER
  snapshot:
    # Recognize Maven SNAPSHOT versions
    pattern: .*-SNAPSHOT
    # Use 'early-access' label for snapshot releases
    label: early-access

# GitLab release configuration
release:
  github:
    # Enable GitLab releases
    enabled: true
    
    # GitLab host (without protocol, JReleaser adds https://)
    host: github.com
    
    # Repository owner (group/namespace)
    owner: RohitRed19
    
    # Repository name
    name: jReleaser-for-proto-code-gen
    
    # Tag name format: v{version} (e.g., v)
    # {{projectVersion}} is automatically resolved from Maven POM
    tagName: v{{projectVersion}}
    
    # Release name format
    releaseName: Release v{{projectVersion}}
    
    # Overwrite existing release with same tag (useful for re-releases)
    overwrite: true
    
    # Skip creating the tag if it already exists
    # Set to true if tags are created by maven-release-plugin
    skipTag: false
    
    # Skip creating the release (only create tag)
    skipRelease: false
    
    # Branch to release from
    branch: main
    
    # Connection timeouts
    connectTimeout: 20
    readTimeout: 60
    
    # Changelog configuration
    changelog:
      enabled: true
      formatted: ALWAYS
      preset: conventional-commits
      # Hide merge commits and bot contributions
      hide:
        categories:
          - merge
        contributors:
          - dependabot
          - renovate

# Hooks to create additional tags for each Go module
hooks:
  command:
    success:
    # Step 1: Create the tag
      - active: RELEASE
        cmd: 'git tag -f hello/go/v{{projectVersion}}'
        verbose: true
        filter:
          includes: [ 'release' ]
    
    # Step 2: Push the tag
      - active: RELEASE
        cmd: 'git push origin hello/go/v{{projectVersion}}'
        verbose: true
        filter:
          includes: [ 'release' ]
